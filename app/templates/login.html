<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SSIS - Login</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />
  </head>
  <body class="login-page">
    <div class="login-container">
      <div class="card shadow p-4 rounded-4">
        <div class="text-center mb-3">
          <div
            style="
              display: inline-flex;
              align-items: center;
              justify-content: center;
              width: 80px;
              height: 80px;
              background-color: rgba(13, 110, 253, 0.1);
              border-radius: 50%;
            "
          >
            <i
              class="bi bi-globe-americas"
              style="font-size: 3rem; color: #0d6efd"
            ></i>
          </div>
        </div>
        <h3 class="text-center mb-1">Welcome Back!</h3>
        <p class="text-center text-muted mb-4">Sign in to your account</p>

        <div style="display: none">
          {% with messages = get_flashed_messages(with_categories=true) %} {% if
          messages %} {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
          {% endfor %} {% endif %} {% endwith %}
        </div>

        <form method="POST" action="{{ url_for('user.login') }}">
          {{ form.hidden_tag() }}

          <div class="mb-3">
            {{ form.username.label(class="form-label") }} {{
            form.username(class="form-control", placeholder="Enter username") }}
            {% for error in form.username.errors %}
            <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>

          <div class="mb-3">
            {{ form.password.label(class="form-label") }}
            <div class="position-relative">
              {{ form.password(class="form-control", placeholder="Enter password", id="password") }}
              <i class="bi bi-eye-slash position-absolute top-50 end-0 translate-middle-y me-3 password-toggle" 
                 id="togglePassword"></i>
            </div>
            {% for error in form.password.errors %}
            <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>

          <div class="form-check mb-3 d-flex align-items-center gap-1">
            {{ form.remember_me(class="form-check-input") }} {{
            form.remember_me.label(class="form-check-label text-muted") }}
          </div>

          <div class="d-grid mb-3">
            {{ form.submit(class="btn btn-primary w-100", value="Sign In") }}
          </div>
        </form>
        <p class="text-center" style="font-size: 0.95rem">
          Don't have an account?
          <a href="{{ url_for('user.register') }}" class="create-account-link"
            >Sign Up</a
          >
        </p>
      </div>
    </div>

    <!-- toast contianer -->
    <div id="toastContainer"></div>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    
    <script>
      const togglePassword = document.getElementById('togglePassword');
      const password = document.getElementById('password');

      togglePassword.addEventListener('click', function () {
        const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
        password.setAttribute('type', type);
        this.classList.toggle('bi-eye');
        this.classList.toggle('bi-eye-slash');
      });
    </script>
  </body>
</html>